---
description: "Projeto ‚Äî Arquitetura + Clean Code (Regras Globais)"
globs:
  - "**/*.ts"
  - "**/*.tsx"
alwaysApply: true
---

# üìå Regras Gerais do Projeto
- 100% do c√≥digo novo deve ser escrito em **TypeScript**.
- Evitar arquivos `.js` (exceto quando estritamente necess√°rio).
- Priorizar **fun√ß√µes puras** e evitar mutabilidade.
- Usar sempre **ES Modules** (`import/export`).

# üß± Arquitetura ‚Äî Regras Obrigat√≥rias

## 1. Estrutura por Camadas (Clean Architecture)

**domain/**
- entidades
- tipos
- regras de neg√≥cio puras
- casos de uso

**application/**
- DTOs
- services
- orquestra√ß√£o de casos de uso
- validadores

**infra/**
- reposit√≥rios concretos
- gateways
- HTTP clients
- drivers externos

**presentation/**
- controllers
- rotas
- view-models
- front-end
- adaptadores

## 2. Repository Pattern
- Toda entidade persistida deve possuir interface de reposit√≥rio dentro de `domain/repositories/`.
- Implementa√ß√µes concretas ficam em `infra/repositories/`.
- **domain nunca deve importar de infra.**

## 3. Service Layer
- Regras de neg√≥cio complexas ficam em `application/services/`.
- Controllers n√£o devem conter l√≥gica ‚Äî apenas chamar services.
- Services n√£o podem conhecer banco ou frameworks.

# üßº Clean Code

## 4. Nomea√ß√£o
- Fun√ß√µes: camelCase
- Classes / interfaces: PascalCase
- Arquivos: kebab-case
- Constantes: UPPER_SNAKE_CASE
- Colunas de banco: snake_case
- Evitar abrevia√ß√µes obscuras.

Exemplo ruim:
function prcUsr(d) {}

Exemplo bom:
function processUser(data) {}

## 5. Tamanho e Responsabilidade
- Fun√ß√µes devem ter at√© ~20 linhas quando poss√≠vel.
- Classes devem ter uma √∫nica responsabilidade.
- Evitar m√∫ltiplos efeitos colaterais.
- Evitar God Classes e God Components.

## 6. Coment√°rios
- Coment√°rios apenas para explicar porqu√™, nunca como.
- C√≥digo deve ser autoexplicativo.

## 7. Tratamento de Erros
- Nunca lan√ßar erros gen√©ricos.
- Criar classes de erro espec√≠ficas por contexto.
- Encapsular erros externos em erros de dom√≠nio.

## 8. Estrutura de Arquivos
- Um arquivo deve conter apenas uma pe√ßa principal.

# ‚öõÔ∏è Regras para React
- Sempre usar Functional Components.
- Extrair subcomponentes quando JSX ficar grande.
- Componentes grandes devem seguir estrutura index/component/styles/types.
- Minimizar estado local.
- Estado global via Zustand/Redux Toolkit/Context.
- Side effects isolados em useEffect.

# ‚öôÔ∏è Testes
- Testes obrigat√≥rios para domain, services e reposit√≥rios mockados.
- Evitar testes fr√°geis.

# üì¶ Padroniza√ß√£o T√©cnica
- Usar ESLint + Prettier.
- Tipar explicitamente retornos.
- Evitar any.

# üîí Seguran√ßa
- Nunca expor valores sens√≠veis.
- Sempre usar .env.
- Sanitizar entradas externas.
- Validar entrada no controller ou caso de uso.

# üîÑ Fluxo de Pull Request
- Proibido c√≥digo sem testes.
- Proibido console.log.
- Revis√µes devem validar responsabilidade, nomes, complexidade e testes.
